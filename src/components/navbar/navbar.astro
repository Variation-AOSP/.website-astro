---
/// <reference types="astro/client" />
import Container from "@/components/container.astro";
import Link from "@/components/ui/link.astro";
import Logo from "./logo.astro";
---

<Container client:load>
  <header>
    <!-- 汉堡菜单按钮 -->
    <button class="menu-button" id="menu-button" onclick="toggleMenu()">
      <span class="menu-icon-top"></span>
      <span class="menu-icon-bottom"></span>
    </button>
    <!-- Logo -->
    <a href="/" class="logo-link">
      <Logo />
    </a>
  </header>

  <!-- 菜单内容 -->
  <div id="menu-container" class="menu-container menu-closed">
    <ul>
      <li><a href="/download" onclick="closeMenu()">Features</a></li>
      <li><a href="/about" onclick="closeMenu()">About</a></li>
      <li><a href="/blog" onclick="closeMenu()">Blog</a></li>
      <li><a href="/legal" onclick="closeMenu()">Legal</a></li>
    </ul>
  </div>

  <script client:load>
    let menu = null;
    let menuButton = null;

    window.toggleMenu = function () {
      menu = menu || document.getElementById("menu-container");
      menuButton = menuButton || document.getElementById("menu-button");
      menu?.classList.toggle("menu-open");
      menuButton?.classList.toggle("menu-btn-open");
    };

    window.closeMenu = function () {
      menu = menu || document.getElementById("menu-container");
      menuButton = menuButton || document.getElementById("menu-button");
      menu?.classList.toggle("menu-open");
      menuButton?.classList.remove("menu-btn-open");
    };
  </script>
</Container>

<style>
  .menu-icon-top,
  .menu-icon-bottom {
    display: block;
    width: 16px;
    height: 2px;
    background-color: var(--md-sys-color-on-background);
    transition: all 0.3s ease;
    transform-origin: center;
  }

  .menu-icon-top {
    transform: translateY(5.5px) rotate(0deg) scaleY(0.75) scaleX(1);
  }

  .menu-icon-bottom {
    transform: translateY(-5.5px) rotate(0deg) scaleY(0.75) scaleX(1);
  }

  .menu-button:hover > .menu-icon-top {
    transform: translateY(0.5px) rotate(0deg) scaleY(0.75) scaleX(1);
  }

  .menu-button:hover > .menu-icon-bottom {
    transform: translateY(-0.5px) rotate(0deg) scaleY(0.75) scaleX(1);
  }

  .menu-btn-open > .menu-icon-top {
    transform: translateY(1px) rotate(45deg) scaleY(0.75) scaleX(1.25);
  }

  .menu-btn-open > .menu-icon-bottom {
    transform: translateY(-1px) rotate(-45deg) scaleY(0.75) scaleX(1.25);
  }

  .menu-btn-open:hover > .menu-icon-top {
    transform: translateY(1px) rotate(90deg) scaleY(0.75) scaleX(1);
  }

  .menu-btn-open:hover > .menu-icon-bottom {
    transform: translateY(-1px) rotate(-90deg) scaleY(0.75) scaleX(1);
  }

  header:has(.menu-btn-open) {
    background-color: color-mix(
      in srgb,
      var(--md-sys-color-background) 0%,
      transparent
    );
    backdrop-filter: blur(0px);
  }

  header {
    background-color: color-mix(
      in srgb,
      var(--md-sys-color-background) 90%,
      transparent
    );
    backdrop-filter: blur(12px);
    z-index: 100;
    position: fixed;
    left: 0;
    right: 0;
    top: 0;
    display: flex;
    justify-content: space-between;
    align-items: center;
    width: 100%;
    padding: 18px 20px;
    box-sizing: border-box;
    transition: all 0.3s cubic-bezier(0, 0.5, 0.5, 1);
  }

  .menu-button {
    background: none;
    border: none;
    cursor: pointer;
    font-size: 1.5rem;
    height: 24px;
    width: 24px;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
  }

  .logo-link {
    font-size: 1.25rem;
    height: 24px;
    /* width: 24px; */
    width: 148px;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
  }

  .menu-closed {
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    transform: scaleY(0);
    transform-origin: top center;
    transition: all 0.3s cubic-bezier(0, 0.5, 0.5, 1);
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    z-index: 90;
  }

  .menu-open {
    background-color: color-mix(
      in srgb,
      var(--md-sys-color-background) 90%,
      transparent
    );
    backdrop-filter: blur(24px);
    transform-origin: top center;
    transform: scaleY(1);
    height: 100vh;
    transition: all 0.3s cubic-bezier(0, 0.5, 0.5, 1);
  }

  body:has(.menu-open) {
    overflow: hidden;
  }

  .menu-container ul {
    list-style-type: none;
    padding: 0;
    margin: 0;
    text-align: center;
  }

  .menu-container ul li {
    margin: 1rem 0;
  }

  .menu-container ul li a {
    text-decoration: none;
    color: #666;
    font-size: 1.25rem;
  }

  .menu-container ul li a:hover {
    color: #333;
  }

  .auth-buttons {
    margin-top: 2rem;
    display: flex;
    flex-direction: column;
    gap: 1rem;
    align-items: center;
  }

  .menu-button svg {
    width: 1.5rem;
    height: 1.5rem;
  }
</style>
